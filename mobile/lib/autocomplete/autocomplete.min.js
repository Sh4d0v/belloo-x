/* teleport-autocomplete - v0.3.1 | https://github.com/teleport/autocomplete#readme | MIT */
!function(a){if("object"==typeof exports&&"undefined"!=typeof module){module.exports=a()}else{if("function"==typeof define&&define.amd){define([],a)}else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.TeleportAutocomplete=a()}}}(function(){return function a(g,c,b){function e(k,h){if(!c[k]){if(!g[k]){var m="function"==typeof require&&require;if(!h&&m){return m(k,!0)}if(d){return d(k,!0)}var i=new Error("Cannot find module '"+k+"'");throw i.code="MODULE_NOT_FOUND",i}var j=c[k]={exports:{}};g[k][0].call(j.exports,function(l){var o=g[k][1][l];return e(o?o:l)},j,j.exports,a,g,c,b)}return c[k].exports}for(var d="function"==typeof require&&require,f=0;f<b.length;f++){e(b[f])}return e}({1:[function(E,S,N){function I(b){return b&&b.__esModule?b:{"default":b}}function Q(b,c){if(!(b instanceof c)){throw new TypeError("Cannot call a class as a function")}}Object.defineProperty(N,"__esModule",{value:!0});var O=function(){function b(c,g){for(var f=0;f<g.length;f++){var d=g[f];d.enumerable=d.enumerable||!1,d.configurable=!0,"value" in d&&(d.writable=!0),Object.defineProperty(c,d.key,d)}}return function(e,d,c){return d&&b(e.prototype,d),c&&b(e,c),e}}();E("classlist-polyfill"),E("element-closest");var R=E("halfred"),A=I(R),T=E("minivents"),C=I(T),L=E("core-js/library/fn/object/assign"),F=I(L),D=E("core-js/library/fn/array/find"),P=I(D),H=E("core-js/library/fn/regexp/escape"),X=I(H),U=E("debounce"),M=I(U),G={BACK:8,TAB:9,ENTER:13,UP:38,DOWN:40},B='<div class="tp-autocomplete"><ul class="tp-ac__list"></ul></div>',z="tp-ac__input",W=function(b){return'<li class="tp-ac__item">'+b+"</li>"},K='<li class="tp-ac__item no-results">No matches</li>',q='<li class="tp-ac__item geolocate">Detect my current location</li>',V=function(b){return this.wrapMatches(b.title)};HTMLElement.prototype.on=HTMLElement.prototype.addEventListener,HTMLElement.prototype.off=HTMLElement.prototype.removeEventListener;var J=function(){function b(){var ae=this,aa=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],w=aa.el,ab=void 0===w?null:w,ad=aa.value,e=aa.maxItems,af=void 0===e?10:e,Z=aa.itemTemplate,j=void 0===Z?V:Z,ac=aa.geoLocate,r=void 0===ac?!0:ac,ai=aa.apiRoot,ag=void 0===ai?"https://api.internal.teleport.org/api":ai,m=aa.apiVersion,f=void 0===m?1:m,c=aa.embeds,ah=void 0===c?"city:country,city:admin1_division,city:timezone/tz:offsets-now,city:urban_area":c;Q(this,b),(0,C["default"])(this);var Y="string"==typeof ab?document.querySelector(ab):ab;return this.setupInput(Y),(0,F["default"])(this,{maxItems:af,geoLocate:r,apiRoot:ag,apiVersion:f,itemTemplate:j,embeds:ah,results:[],_activeIndex:0,_cache:{},_query:this.el.value,value:ad}),this.value&&this.value.title?this.query=this.value.title:this.query&&this.fetchResults(function(){ae.value=ae.getResultByTitle(ae.query),ae.emit("change",ae.value)}),this.getCities=(0,M["default"])(this.getCities,200),this}return O(b,[{key:"query",get:function(){return this._query},set:function(c){return c===this._query?c:(this._query=c,this.el.value=c,void this.emit("querychange",c))}},{key:"activeIndex",get:function(){return this._activeIndex},set:function(c){var f=this.list.childNodes[this._activeIndex];f&&f.classList.remove("is-active"),this._activeIndex=c;var d=this.list.childNodes[c];d&&d.classList.add("is-active")}},{key:"loading",set:function(c){this.container.classList.toggle("spinner",c)}}]),O(b,[{key:"destroy",value:function(){this.el.off("input",this.oninput),this.el.off("keydown",this.onkeydown),this.el.off("focus",this.onfocus),this.el.off("blur",this.onblur),this.el.off("click",this.onclick),this.el.classList.remove(z);var c=this.container.parentNode;c.replaceChild(this.el.parentNode.removeChild(this.el),this.container)}},{key:"clear",value:function(){this.results=[],this.selectByIndex(0)}},{key:"setupInput",value:function(c){if(!(c&&c instanceof HTMLInputElement)){throw new Error("Invalid element given")}c.insertAdjacentHTML("beforebegin",B),Object.defineProperty(this,"container",{value:c.previousSibling}),Object.defineProperty(this,"list",{value:this.container.firstChild});var d=this.container.insertBefore(c.parentNode.removeChild(c),this.list);d.classList.add(z),Object.defineProperty(this,"el",{enumerable:!0,value:d}),this.el.on("input",this.oninput.bind(this)),this.el.on("keydown",this.onkeydown.bind(this)),this.el.on("focus",this.onfocus.bind(this)),this.el.on("blur",this.onblur.bind(this)),this.el.on("click",this.onclick.bind(this)),this.list.on("mousedown",this.onlistclick.bind(this))}},{key:"onlistclick",value:function(c){c.preventDefault();this.selectByIndex(this.activeIndex)}},{key:"onclick",value:function(){this.el.select()}},{key:"onfocus",value:function(){this.renderList()}},{key:"onblur",value:function(){this.list.innerHTML=""}},{key:"oninput",value:function(){var c=this;this._query=this.el.value,this.fetchResults(function(){return c.renderList()})}},{key:"onkeydown",value:function(c){var d=c.keyCode;switch(-1!==[G.UP,G.DOWN].indexOf(d)&&c.preventDefault(),d){case G.BACK:(this.value||1===this.query.length)&&this.clear();break;case G.ENTER:!this.value&&this.query&&c.preventDefault(),this.selectByIndex(this.activeIndex);break;case G.TAB:this.value||this.selectByIndex(this.activeIndex);break;case G.UP:this.activeIndex=Math.max(0,this.activeIndex-1);break;case G.DOWN:this.activeIndex=Math.min(this.results.length-1,this.activeIndex+1)}}},{key:"selectByIndex",value:function(c){this.activeIndex=c;var f=this.value;this.value=this.results[c]||null;locationUpdated(this.value);var d=this.list.firstChild&&this.list.firstChild.classList.contains("geolocate");d&&this.currentLocation(),f===this.value||d||this.emit("change",this.value),this.list.innerHTML="",this.query=this.value?this.value.title:""}},{key:"wrapMatches",value:function(){var c=arguments.length<=0||void 0===arguments[0]?"":arguments[0],d=c;return this.query.split(/[\,\s]+/).filter(function(f){return !!f}).forEach(function(f){var g=new RegExp((0,X["default"])(f)+"(?![^<]*>|[^<>]*</)","gi");d=d.replace(g,"<span>$&</span>")}),d}},{key:"renderList",value:function(){var c=this,h=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],f=h.geoLocate,d=void 0===f?this.geoLocate:f,g=this.results.map(function(e){return W(c.itemTemplate(e))}).slice(0,this.maxItems).join("");g||""===this.query||this.value||(g=K),""===this.query&&d&&(g=q),this.list.innerHTML=g,this.activeIndex=0}},{key:"getResultByTitle",value:function(c){return this.results&&c?(0,P["default"])(this.results,function(d){return -1!==d.title.indexOf(c)}):null}},{key:"fetchResults",value:function(){var c=this,f=arguments.length<=0||void 0===arguments[0]?function(){}:arguments[0];this.req&&this.req.abort();var d=this._cache[this.query];return d?(this.results=d,f()):(this.req=this.getCities(function(e){c.results=c._cache[c.query]=e,f(),c.loading=!1}),void (this.loading=!0))}},{key:"currentLocation",value:function(){var c=this,f=new XMLHttpRequest,d="location:nearest-cities/location:nearest-city/"+(this.embeds?"{"+this.embeds+"}":"");this.loading=!0,this.oldPlaceholder=this.el.placeholder,this.el.placeholder="Detecting location...",navigator.geolocation.getCurrentPosition(function(e){var g=e.coords;f.open("GET",c.apiRoot+"/locations/"+g.latitude+","+g.longitude+"/?embed="+d),f.setRequestHeader("Accept","application/vnd.teleport.v"+c.apiVersion+"+json"),f.addEventListener("load",function(){return c.parseLocation(JSON.parse(f.response))}),f.send()},function(g){var e=g.message;c.loading=!1,c.el.placeholder=e,setTimeout(function(){return c.el.placeholder=c.oldPlaceholder},3000)},{timeout:5000})}},{key:"parseLocation",value:function(c){var f=A["default"].parse(c),d=f.embeddedArray("location:nearest-cities")[0];d&&(this.results=[this.parseCity(d)],"nopick"===this.geoLocate?(this.el.focus(),this.renderList({geoLocate:!1})):this.selectByIndex(0)),this.loading=!1,this.el.placeholder=this.oldPlaceholder
}},{key:"getCities",value:function(c){var g=this;if(!this.query){return c([])}var f="city:search-results/city:item/"+(this.embeds?"{"+this.embeds+"}":""),d=new XMLHttpRequest;return d.open("GET",this.apiRoot+"/cities/?search="+this.query+"&embed="+f+"&limit="+this.maxItems),d.setRequestHeader("Accept","application/vnd.teleport.v"+this.apiVersion+"+json"),d.addEventListener("load",function(){var e=A["default"].parse(JSON.parse(d.response)).embeddedArray("city:search-results").map(function(h){return g.parseCity(h)});c(e)}),d.send(),d}},{key:"parseCity",value:function(Z){var ak=Z.embedded("location:nearest-city")||Z.embedded("city:item");ak.country=ak.embedded("city:country"),ak.admin1_division=ak.embedded("city:admin1_division"),ak.timezone=ak.embedded("city:timezone"),ak.urban_area=ak.embedded("city:urban_area");var af=ak.full_name,ac=ak.name,ai=ak.geoname_id,ag=ak.population,aj=ak.location.latlon,j=aj.latitude,al=aj.longitude,w=Z.matching_full_name,ad=void 0===w?af:w,Y={title:ad,name:ac,geonameId:ai,latitude:j,longitude:al,population:ag};if(ak.country&&(0,F["default"])(Y,{country:ak.country.name}),ak.admin1_division){var ah=ak.admin1_division,ab=ah.name,ao=ah.geonames_admin1_code;(0,F["default"])(Y,{admin1Division:ab,admin1DivisionCode:ao})}if(ak.timezone){var am=ak.timezone.embedded("tz:offsets-now");(0,F["default"])(Y,{tzOffsetMinutes:am.total_offset_min})}if(ak.urban_area){var ae=ak.urban_area,aa=ae.slug,k=ae.name,f=ae.ua_id,an=ae.teleport_city_url;(0,F["default"])(Y,{uaName:k,uaId:f,uaCityUrl:an,uaSlug:aa})}return Y}}],[{key:"init",value:function(e){var d=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],c="string"==typeof e||e instanceof HTMLInputElement?(0,F["default"])(d,{el:e}):e;return new b(c)}}]),b}();N["default"]=J,S.exports=N["default"]},{"classlist-polyfill":2,"core-js/library/fn/array/find":3,"core-js/library/fn/object/assign":4,"core-js/library/fn/regexp/escape":5,debounce:33,"element-closest":34,halfred:35,minivents:39}],2:[function(b,d,c){"document" in window.self&&("classList" in document.createElement("_")?!function(){var f=document.createElement("_");if(f.classList.add("c1","c2"),!f.classList.contains("c2")){var h=function(i){var j=DOMTokenList.prototype[i];DOMTokenList.prototype[i]=function(k){var m,l=arguments.length;for(m=0;l>m;m++){k=arguments[m],j.call(this,k)}}};h("add"),h("remove")}if(f.classList.toggle("c3",!1),f.classList.contains("c3")){var g=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(i,j){return 1 in arguments&&!this.contains(i)==!j?j:g.call(this,i)}}f=null}():!function(k){if("Element" in k){var B="classList",w="prototype",q=k.Element[w],z=Object,x=String[w].trim||function(){return this.replace(/^\s+|\s+$/g,"")},A=Array[w].indexOf||function(f){for(var l=0,i=this.length;i>l;l++){if(l in this&&this[l]===f){return l}}return -1},g=function(f,i){this.name=f,this.code=DOMException[f],this.message=i},C=function(f,i){if(""===i){throw new g("SYNTAX_ERR","An invalid or illegal string was specified")}if(/\s/.test(i)){throw new g("INVALID_CHARACTER_ERR","String contains an invalid character")}return A.call(f,i)},h=function(f){for(var s=x.call(f.getAttribute("class")||""),o=s?s.split(/\s+/):[],l=0,p=o.length;p>l;l++){this.push(o[l])}this._updateClassName=function(){f.setAttribute("class",this.toString())}},v=h[w]=[],m=function(){return new h(this)};if(g[w]=Error[w],v.item=function(f){return this[f]||null},v.contains=function(f){return f+="",-1!==C(this,f)},v.add=function(){var f,s=arguments,o=0,l=s.length,p=!1;do{f=s[o]+"",-1===C(this,f)&&(this.push(f),p=!0)}while(++o<l);p&&this._updateClassName()},v.remove=function(){var f,D,p=arguments,l=0,u=p.length,s=!1;do{for(f=p[l]+"",D=C(this,f);-1!==D;){this.splice(D,1),s=!0,D=C(this,f)}}while(++l<u);s&&this._updateClassName()},v.toggle=function(f,p){f+="";var o=this.contains(f),l=o?p!==!0&&"remove":p!==!1&&"add";return l&&this[l](f),p===!0||p===!1?p:!o},v.toString=function(){return this.join(" ")},z.defineProperty){var j={get:m,enumerable:!0,configurable:!0};try{z.defineProperty(q,B,j)}catch(y){-2146823252===y.number&&(j.enumerable=!1,z.defineProperty(q,B,j))}}else{z[w].__defineGetter__&&q.__defineGetter__(B,m)}}}(window.self))},{}],3:[function(b,d,c){b("../../modules/es6.array.find"),d.exports=b("../../modules/$.core").Array.find},{"../../modules/$.core":11,"../../modules/es6.array.find":29}],4:[function(b,d,c){b("../../modules/es6.object.assign"),d.exports=b("../../modules/$.core").Object.assign},{"../../modules/$.core":11,"../../modules/es6.object.assign":30}],5:[function(b,d,c){b("../../modules/es7.regexp.escape"),d.exports=b("../../modules/$.core").RegExp.escape},{"../../modules/$.core":11,"../../modules/es7.regexp.escape":31}],6:[function(b,d,c){d.exports=function(f){if("function"!=typeof f){throw TypeError(f+" is not a function!")}return f}},{}],7:[function(b,d,c){d.exports=function(){}},{}],8:[function(c,k,f){var d=c("./$.ctx"),h=c("./$.iobject"),g=c("./$.to-object"),j=c("./$.to-length"),b=c("./$.array-species-create");k.exports=function(m){var r=1==m,q=2==m,s=3==m,i=4==m,p=6==m,o=5==m||p;return function(n,A,u){for(var D,B,z=g(n),t=h(z),l=d(A,u,3),e=j(t.length),C=0,w=r?b(n,e):q?b(n,0):void 0;e>C;C++){if((o||C in t)&&(D=t[C],B=l(D,C,z),m)){if(r){w[C]=B}else{if(B){switch(m){case 3:return !0;case 5:return D;case 6:return C;case 2:w.push(D)}}else{if(i){return !1}}}}}return p?-1:s||i?i:w}}},{"./$.array-species-create":9,"./$.ctx":12,"./$.iobject":17,"./$.to-length":25,"./$.to-object":26}],9:[function(b,h,d){var c=b("./$.is-object"),g=b("./$.is-array"),f=b("./$.wks")("species");h.exports=function(i,k){var j;return g(i)&&(j=i.constructor,"function"!=typeof j||j!==Array&&!g(j.prototype)||(j=void 0),c(j)&&(j=j[f],null===j&&(j=void 0))),new (void 0===j?Array:j)(k)}},{"./$.is-array":18,"./$.is-object":19,"./$.wks":28}],10:[function(b,f,d){var c={}.toString;f.exports=function(g){return c.call(g).slice(8,-1)}},{}],11:[function(b,f,d){var c=f.exports={version:"1.2.6"};"number"==typeof __e&&(__e=c)},{}],12:[function(b,f,d){var c=b("./$.a-function");f.exports=function(g,i,h){if(c(g),void 0===i){return g}switch(h){case 1:return function(e){return g.call(i,e)};case 2:return function(j,e){return g.call(i,j,e)};case 3:return function(j,e,k){return g.call(i,j,e,k)}}return function(){return g.apply(i,arguments)}}},{"./$.a-function":6}],13:[function(b,d,c){d.exports=function(f){if(void 0==f){throw TypeError("Can't call method on  "+f)}return f}},{}],14:[function(c,k,f){var d=c("./$.global"),h=c("./$.core"),g=c("./$.ctx"),j="prototype",b=function(q,C,A){var D,i,x,r=q&b.F,o=q&b.G,B=q&b.S,w=q&b.P,F=q&b.B,E=q&b.W,z=o?h:h[C]||(h[C]={}),s=o?d:B?d[C]:(d[C]||{})[j];o&&(A=C);for(D in A){i=!r&&s&&D in s,i&&D in z||(x=i?s[D]:A[D],z[D]=o&&"function"!=typeof s[D]?A[D]:F&&i?g(x,d):E&&s[D]==x?function(l){var m=function(e){return this instanceof l?new l(e):l(e)};return m[j]=l[j],m}(x):w&&"function"==typeof x?g(Function.call,x):x,w&&((z[j]||(z[j]={}))[D]=x))}};b.F=1,b.G=2,b.S=4,b.P=8,b.B=16,b.W=32,k.exports=b},{"./$.core":11,"./$.ctx":12,"./$.global":16}],15:[function(b,d,c){d.exports=function(f){try{return !!f()}catch(g){return !0}}},{}],16:[function(b,f,d){var c=f.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=c)},{}],17:[function(b,f,d){var c=b("./$.cof");f.exports=Object("z").propertyIsEnumerable(0)?Object:function(g){return"String"==c(g)?g.split(""):Object(g)}},{"./$.cof":10}],18:[function(b,f,d){var c=b("./$.cof");f.exports=Array.isArray||function(g){return"Array"==c(g)}},{"./$.cof":10}],19:[function(b,d,c){d.exports=function(f){return"object"==typeof f?null!==f:"function"==typeof f}},{}],20:[function(b,f,d){var c=Object;f.exports={create:c.create,getProto:c.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:c.getOwnPropertyDescriptor,setDesc:c.defineProperty,setDescs:c.defineProperties,getKeys:c.keys,getNames:c.getOwnPropertyNames,getSymbols:c.getOwnPropertySymbols,each:[].forEach}
},{}],21:[function(b,h,d){var c=b("./$"),g=b("./$.to-object"),f=b("./$.iobject");h.exports=b("./$.fails")(function(){var j=Object.assign,o={},l={},k=Symbol(),m="abcdefghijklmnopqrst";return o[k]=7,m.split("").forEach(function(i){l[i]=i}),7!=j({},o)[k]||Object.keys(j({},l)).join("")!=m})?function(m,A){for(var w=g(m),z=arguments,i=z.length,B=1,j=c.getKeys,r=c.getSymbols,o=c.isEnum;i>B;){for(var k,x=f(z[B++]),q=r?j(x).concat(r(x)):j(x),D=q.length,C=0;D>C;){o.call(x,k=q[C++])&&(w[k]=x[k])}}return w}:Object.assign},{"./$":20,"./$.fails":15,"./$.iobject":17,"./$.to-object":26}],22:[function(b,d,c){d.exports=function(f,h){var g=h===Object(h)?function(i){return h[i]}:h;return function(e){return String(e).replace(f,g)}}},{}],23:[function(b,h,d){var c=b("./$.global"),g="__core-js_shared__",f=c[g]||(c[g]={});h.exports=function(i){return f[i]||(f[i]={})}},{"./$.global":16}],24:[function(b,g,d){var c=Math.ceil,f=Math.floor;g.exports=function(h){return isNaN(h=+h)?0:(h>0?f:c)(h)}},{}],25:[function(b,g,d){var c=b("./$.to-integer"),f=Math.min;g.exports=function(h){return h>0?f(c(h),9007199254740991):0}},{"./$.to-integer":24}],26:[function(b,f,d){var c=b("./$.defined");f.exports=function(g){return Object(c(g))}},{"./$.defined":13}],27:[function(b,g,d){var c=0,f=Math.random();g.exports=function(h){return"Symbol(".concat(void 0===h?"":h,")_",(++c+f).toString(36))}},{}],28:[function(b,h,d){var c=b("./$.shared")("wks"),g=b("./$.uid"),f=b("./$.global").Symbol;h.exports=function(i){return c[i]||(c[i]=f&&f[i]||(f||g)("Symbol."+i))}},{"./$.global":16,"./$.shared":23,"./$.uid":27}],29:[function(b,j,d){var c=b("./$.export"),g=b("./$.array-methods")(5),f="find",h=!0;f in []&&Array(1)[f](function(){h=!1}),c(c.P+c.F*h,"Array",{find:function(i){return g(this,i,arguments.length>1?arguments[1]:void 0)}}),b("./$.add-to-unscopables")(f)},{"./$.add-to-unscopables":7,"./$.array-methods":8,"./$.export":14}],30:[function(b,f,d){var c=b("./$.export");c(c.S+c.F,"Object",{assign:b("./$.object-assign")})},{"./$.export":14,"./$.object-assign":21}],31:[function(b,g,d){var c=b("./$.export"),f=b("./$.replacer")(/[\\^$*+?.()|[\]{}]/g,"\\$&");c(c.S,"RegExp",{escape:function(h){return f(h)}})},{"./$.export":14,"./$.replacer":22}],32:[function(b,f,d){function c(){return(new Date).getTime()}f.exports=Date.now||c},{}],33:[function(b,f,d){var c=b("date-now");f.exports=function(i,p,j){function l(){var e=c()-q;p>e&&e>0?k=setTimeout(l,p-e):(k=null,j||(h=i.apply(g,m),k||(g=m=null)))}var k,m,g,q,h;return null==p&&(p=100),function(){g=this,m=arguments,q=c();var e=j&&!k;return k||(k=setTimeout(l,p)),e&&(h=i.apply(g,m),g=m=null),h}}},{"date-now":32}],34:[function(b,d,c){!function(f){f.matches=f.matches||f.mozMatchesSelector||f.msMatchesSelector||f.oMatchesSelector||f.webkitMatchesSelector,f.closest=f.closest||function(g){for(var h=this;h&&!h.matches(g);){h=h.parentElement}return h}}(Element.prototype)},{}],35:[function(b,h,d){var c=b("./lib/parser"),g=b("./lib/resource"),f=!1;h.exports={parse:function(i){return(new c).parse(i,f)},enableValidation:function(i){f=null!=i?i:!0},disableValidation:function(){f=!1},Resource:g}},{"./lib/parser":37,"./lib/resource":38}],36:[function(b,f,d){function c(){arguments.length>=1?this._array=arguments[0]:this._array=[]}c.prototype.array=function(){return this._array},c.prototype.isEmpty=function(g){return 0===this._array.length},c.prototype.push=function(g){var h=this._array.slice(0);return h.push(g),new c(h)},c.prototype.pop=function(){var g=this._array.slice(0,this._array.length-1);return new c(g)},c.prototype.peek=function(){if(this.isEmpty()){throw new Error("can't peek on empty stack")}return this._array[this._array.length-1]},f.exports=c},{}],37:[function(A,M,H){function E(){}function K(d,o,h){if(null==d){return d}var f=I(d._links,o,h.push("_links")),m=L(f),b=k(d._embedded,o,h.push("_embedded")),g=new q(f,m,b,o);return N(d,g),g._original=d,g}function I(b,d,c){return b=w(b,B,d,c),null!=b&&null!=b.self||Q("Resource does not have a self link",d,c),b}function L(b){return b?b.curies:[]}function k(b,f,d){var c=w(b,D,f,d);return null==c?c:(Object.keys(c).forEach(function(g){c[g]=c[g].map(function(e){var h=null!=f?[]:null,l=K(e,h,d.push(g));return l._original=e,l})}),c)}function N(b,c){Object.keys(b).forEach(function(d){"_links"!==d&&"_embedded"!==d&&(c[d]=b[d])})}function w(b,g,d,c){if(null==b){return b}var f={};return Object.keys(b).forEach(function(e){f[e]=F(e,b[e],g,d,c)}),f}function F(b,g,d,c,f){return z(g)?g.map(function(e){return d(b,e,c,f)}):[d(b,g,c,f)]}function B(b,g,d,c){if(!J(g)){throw new Error("Link object is not an actual object: "+g+" ["+typeof g+"]")}var f=G(g);return Object.keys(P).forEach(function(e){null==f[e]&&(P[e].required&&Q("Link misses required property "+e+".",d,c.push(b)),null!=P[e].defaultValue&&(f[e]=P[e].defaultValue))}),f.deprecation&&O("Warning: Link "+C(c.push(b))+" is deprecated, see "+f.deprecation),f.templated!==!0&&f.templated!==!1&&(f.templated=!1),d?(f.href&&f.href.indexOf("{")>=0&&!f.templated&&Q('Link seems to be an URI template but its "templated" property is not set to true.',d,c.push(b)),f):f}function z(b){return"[object Array]"===Object.prototype.toString.call(b)}function J(b){return"object"==typeof b}function D(b,c){return c}function Q(b,d,c){d&&d.push({path:C(c),message:b})}function O(b){"undefined"!=typeof console&&"function"==typeof console.log&&console.log(b)}function G(b){var c={};return Object.keys(b).forEach(function(d){c[d]=b[d]}),c}function C(b){for(var d="$.",c=0;c<b.array().length;c++){d+=b.array()[c]+"."}return d=d.substring(0,d.length-1)}var q=A("./resource"),j=A("./immutable_stack"),P={href:{required:!0,defaultValue:null},templated:{required:!1,defaultValue:!1},type:{required:!1,defaultValue:null},deprecation:{required:!1,defaultValue:null},name:{required:!1,defaultValue:null},profile:{required:!1,defaultValue:null},title:{required:!1,defaultValue:null},hreflang:{required:!1,defaultValue:null}};E.prototype.parse=function(b,d){var c=d?[]:null;return K(b,c,new j)},M.exports=E},{"./immutable_stack":36,"./resource":38}],38:[function(b,h,d){function c(j,m,l,k){this._links=j||{},this._initCuries(m),this._embedded=l||{},this._validation=k||[]}function g(i,j){return null!=i?i[j]:null}function f(j,m,l){l=l||0;var k=g(j,m);return null!=k&&k.length>=1?k[l]:null}c.prototype._initCuries=function(i){if(this._curiesMap={},i){this._curies=i;for(var k=0;k<this._curies.length;k++){var j=this._curies[k];this._curiesMap[j.name]=j}}else{this._curies=[]}this._preResolveCuries()},c.prototype._preResolveCuries=function(){this._resolvedCuriesMap={};for(var i=0;i<this._curies.length;i++){var k=this._curies[i];if(k.name){for(var j in this._links){"curies"!==j&&this._preResolveCurie(k,j)}}}},c.prototype._preResolveCurie=function(j,o){var l=(this._links[o],o.split(/:(.+)/)),k=l[0];if(j.name===k){if(j.templated&&l.length>=1){var m=j.href.replace(/(.*){(.*)}(.*)/,"$1"+l[1]+"$3");this._resolvedCuriesMap[m]=o}else{this._resolvedCuriesMap[j.href]=o}}},c.prototype.allLinkArrays=function(){return this._links},c.prototype.linkArray=function(i){return g(this._links,i)},c.prototype.link=function(i,j){return f(this._links,i,j)},c.prototype.hasCuries=function(i){return this._curies.length>0},c.prototype.curieArray=function(i){return this._curies},c.prototype.curie=function(i){return this._curiesMap[i]},c.prototype.reverseResolveCurie=function(i){return this._resolvedCuriesMap[i]},c.prototype.allEmbeddedResourceArrays=function(){return this._embedded},c.prototype.embeddedResourceArray=function(i){return g(this._embedded,i)},c.prototype.embeddedResource=function(i,j){return f(this._embedded,i,j)},c.prototype.original=function(){return this._original},c.prototype.validationIssues=function(){return this._validation},c.prototype.allLinks=c.prototype.allLinkArrays,c.prototype.allEmbeddedArrays=c.prototype.allEmbeddedResources=c.prototype.allEmbeddedResourceArrays,c.prototype.embeddedArray=c.prototype.embeddedResourceArray,c.prototype.embedded=c.prototype.embeddedResource,c.prototype.validation=c.prototype.validationIssues,h.exports=c
},{}],39:[function(b,d,c){d.exports=function(f){var h={},g=[];f=f||this,f.on=function(j,l,k){(h[j]=h[j]||[]).push([l,k])},f.off=function(j,k){j||(h={});for(var m=h[j]||g,l=m.length=k?m.length:0;l--;){k==m[l][0]&&m.splice(l,1)}},f.emit=function(j){for(var k,m=h[j]||g,l=0;k=m[l++];){k[0].apply(k[1],g.slice.call(arguments,1))}}}},{}]},{},[1])(1)});